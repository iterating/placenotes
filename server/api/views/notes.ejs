<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes</title>
</head>
<body>
    <form action="/users/logout" method="post">
        <button type="submit">Log Out</button>
    </form>
    <h1>Your Notes</h1>
    <ul>
        <% if (notes.length > 0) { %>
            <% notes.forEach(note => { %>
                <% if (note.userId && user && user._id && note.userId.toString() === user._id.toString()) { %>
                    <li>
                        <p><%= note.body %></p>
                        <p>Location: <%= note.location.lat %>, <%= note.location.lon %></p>
                        <p>Posted at <%= note.createdAt.toLocaleString() %></p>
                    </li>
                <% } %>
            <% }); %>
        <% } else { %>
            <p>You don't have any notes yet.</p>
        <% } %>
    </ul>
    <h2>Create a new note</h2>
    <form action="/notes/new" method="post">
        <label for="note-body">Note:</label><br>
        <textarea name="body" id="note-body" rows="4" cols="30" required></textarea><br>
        <label for="note-lat">Latitude:</label><br>
        <input type="number" name="location[lat]" id="note-lat" required><br>
        <label for="note-lon">Longitude:</label><br>
        <input type="number" name="location[lon]" id="note-lon" required><br>
        <input type="submit" value="Create Note">
    </form>
    
</body>
</html>

